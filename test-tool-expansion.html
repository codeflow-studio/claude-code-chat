<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Tool Expansion</title>
    <link rel="stylesheet" href="media/styles.css">
    <style>
        body {
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #454545;
            border-radius: 8px;
            background: #252526;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Tool Usage Block Expansion Test</h1>
        
        <div class="test-section">
            <h2>Test: Regular Tool Usage Block</h2>
            <p>This should be clickable and expandable now:</p>
            
            <div id="directModeMessages">
                <!-- Test tool usage block will be inserted here -->
            </div>
        </div>
        
        <div class="test-section">
            <h2>Instructions</h2>
            <p>1. Click on the tool usage block above</p>
            <p>2. It should expand to show the tool result content</p>
            <p>3. Click again to collapse it</p>
            <p>4. The expand indicator (▶/▼) should change accordingly</p>
        </div>
    </div>

    <script type="module">
        // Import our message handler
        import { createMessage, addDirectModeMessage } from './media/js/modules/messageHandler.js';
        
        // Create a test tool usage message
        const testMessage = {
            type: 'assistant',
            content: 'I\'ll help you edit that file.',
            timestamp: Date.now(),
            metadata: {
                originalMessage: {
                    message: {
                        content: [
                            {
                                type: 'text',
                                text: 'I\'ll help you edit that file.'
                            },
                            {
                                type: 'tool_use',
                                id: 'toolu_test123',
                                name: 'Edit',
                                input: {
                                    file_path: 'ILLUSTRATION_SYSTEM_REDESIGN.md',
                                    old_string: 'old content',
                                    new_string: 'new content'
                                }
                            }
                        ]
                    }
                }
            }
        };
        
        // Add the test message to the container
        addDirectModeMessage(
            testMessage.type,
            testMessage.content,
            testMessage.timestamp,
            null,
            testMessage.metadata,
            null,
            false,
            false,
            {
                toolExecutions: [{
                    id: 'toolu_test123',
                    name: 'Edit',
                    status: 'completed',
                    input: {
                        file_path: 'ILLUSTRATION_SYSTEM_REDESIGN.md',
                        old_string: 'old content',
                        new_string: 'new content'
                    },
                    result: {
                        content: '1→# Illustration System Redesign\n2→\n3→This is the new content for the file.\n4→\n5→## Changes Made\n6→- Updated content\n7→- Improved structure',
                        tool_use_id: 'toolu_test123'
                    }
                }],
                executionGroup: {
                    id: 'group_test123',
                    executions: [{
                        id: 'toolu_test123',
                        name: 'Edit',
                        status: 'completed',
                        input: {
                            file_path: 'ILLUSTRATION_SYSTEM_REDESIGN.md',
                            old_string: 'old content',
                            new_string: 'new content'
                        },
                        result: {
                            content: '1→# Illustration System Redesign\n2→\n3→This is the new content for the file.\n4→\n5→## Changes Made\n6→- Updated content\n7→- Improved structure',
                            tool_use_id: 'toolu_test123'
                        }
                    }]
                }
            }
        );
        
        console.log('Test tool usage block created. Try clicking on it!');
    </script>
</body>
</html>